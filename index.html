<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アドベントカレンダー</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🐶</text></svg>">
    <!-- Tailwind CSS CDNを読み込みます -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- InterとYomogiフォントを読み込みます -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Yomogi&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            /* 背景を雪が積もったような明るいグレーに */
            background-color: #f0f4f8;
        }

        /* タイトル専用の可愛い日本語フォントスタイル */
        .font-cute-japanese {
            font-family: 'Yomogi', cursive; /* 手書き風のYomogiを適用 */
            letter-spacing: 0.1em; /* 少し文字間を空けて可愛らしさを強調 */
            font-weight: 400; /* Yomogiは太字にしすぎない方が可愛らしい */
        }

        /* 金色のテキストに影をつけて、きらめきを表現 */
        .text-gold-shadow {
            text-shadow: 1px 1px 3px rgba(255, 215, 0, 0.5);
        }
        /* カードのアニメーション（扉が開く前の輝き） */
        .day-card {
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        }

        .day-card:hover {
            /* ロックされていないカードのみホバーエフェクトを適用 */
            box-shadow: 0 20px 25px -5px rgba(239, 68, 68, 0.3), 0 10px 10px -5px rgba(251, 191, 36, 0.2);
        }
        /* ロック状態のカードのスタイル */
        .day-card[data-locked="true"] {
            opacity: 0.4; /* 透明度を下げて無効に見せる */
            cursor: not-allowed; /* マウスカーソルを禁止マークに */
            filter: grayscale(80%); /* グレースケールで色味を抑える */
            box-shadow: none;
            transform: none !important; /* ホバーによる移動を無効化 */
        }

        .day-card[data-locked="true"]:hover {
            box-shadow: none;
            transform: none;
        }

        /* === モーダル（手紙が飛び出すフリップ）アニメーションのためのカスタムスタイル === */
        #feature-detail-modal {
            perspective: 1000px;
        }

        .modal-content-box {
            display: flex; /* 【追加】Flexboxレイアウト */
            flex-direction: column; /* 【追加】縦並び */
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 0.4s ease-out;
            transform-style: preserve-3d;
            /* モーダル自体が画面高さを超えないように max-h-screen を適用 */
            max-height: 100vh;
        }

        .modal-start-state {
            opacity: 0;
            transform: rotateX(45deg) scale(0.7);
        }

        .modal-end-state {
            opacity: 1;
            transform: rotateX(0deg) scale(1.0);
        }
        /* === End of Custom Modal Style === */

        /* === ロックメッセージボックスのスタイル === */
        #lock-message-box {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            min-width: 300px;
            padding: 12px 24px;
            background-color: #ef4444; /* 赤色 */
            color: white;
            border-radius: 9999px; /* 角丸を最大限に */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, top 0.3s ease-in-out;
        }

        .show-message {
            opacity: 1 !important;
            top: 80px !important;
        }

        /* === NEW: 画像サイズのカスタムスタイル === */
        /* Tailwindのクラスがない特定の高さを指定するためのCSS */
        .image-custom-h-400 {
            height: 400px;
        }

        .image-custom-h-200 {
            height: 200px;
        }
    </style>
    <!-- jQuery CDNを読み込みます -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<!-- overflow-x-hidden を追加して横スクロールを防止 -->
<body class="text-gray-800 overflow-x-hidden">

    <!-- ヘッダー (タイトルのみ) -->
    <header class="bg-red-800 shadow-xl fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-center items-center h-16">
                <!-- ロゴ/サイト名 (金色) - モバイルでは文字サイズを少し小さく(text-xl)調整 -->
                <h1 class="text-xl md:text-3xl font-extrabold text-amber-400 text-gold-shadow p-2 transition font-cute-japanese whitespace-nowrap">
                    🎄 勝手に 🎁
                </h1>
            </div>
        </div>
    </header>

    <main class="pt-16">
        <!-- ヒーローセクション (説明用) -->
        <section id="hero" class="bg-gradient-to-br from-red-700 to-red-900 text-white py-12 md:py-16 shadow-inner">
            <div class="max-w-4xl mx-auto text-center px-4">
                <h2 class="text-3xl sm:text-4xl font-extrabold mb-4 leading-tight text-amber-400 text-gold-shadow">
                    アドベントカレンダー<br>★2025★
                </h2>
                <p class="text-lg mb-0 opacity-90 font-cute-japanese">
                🐶♥の話、無作為に詰めてます。
                </p>
                <!-- **デモ用日付表示 (このメッセージは公開時には消すことができます)** -->
                <div id="date-info" class="mt-4 text-sm font-bold text-amber-200"></div>
            </div>
        </section>

        <!-- アドベントカレンダーセクション (25枚のカード) -->
        <section id="features" class="py-16 md:py-24">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- レスポンシブなグリッドレイアウト: モバイル2列 -> タブレット3列 -> PC 4-5列 -->
                <div id="advent-calendar-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-6">
                    <!-- カードはJavaScriptでここに挿入されます -->
                </div>
            </div>
        </section>
    </main>

    <!-- フッター (深紅の背景) -->
    <footer class="bg-red-800 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center text-sm opacity-80">
            &copy; 2024 Advent Magic. Merry Christmas!
        </div>
    </footer>

    <!-- === 特徴の詳細モーダル (深紅のオーバーレイと金色のアクセント) === -->
    <div id="feature-detail-modal" class="hidden fixed inset-0 bg-red-900 bg-opacity-80 z-[9999] flex items-center justify-center p-4">
        <!-- p-0で外側のパディングをなくし、ボタンを端に配置しやすくする -->
        <div class="modal-content-box bg-white w-full max-w-xl p-0 rounded-xl shadow-2xl relative border-4 border-amber-400 modal-start-state">
            <!-- ボタンに z-20 と背景色を追加して、スクロールしても前面に見えるようにする -->
            <button id="close-modal-button" class="absolute top-4 right-4 z-20 text-gray-500 hover:text-red-700 bg-white/80 rounded-full p-1 transition shadow-sm">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <!-- スクロール可能なコンテンツのラッパー (paddingはここに移動) -->
            <div class="overflow-y-auto p-2 pb-20 flex-1 custom-scrollbar">
                <!-- 大きな文字と下にラインを入れることで、タイトルと本文の区切りを明確に -->
                <h2 id="modal-header-text" class="text-2xl sm:text-3xl font-extrabold text-red-700 mb-6 border-b-2 pb-2 border-red-100 flex-shrink-0 text-center">
                    <!-- ここにheaderTextが動的に挿入されます -->
                </h2>

                <!-- アイコン表示用のコンテナ -->
                <div id="modal-icon-container" class="text-amber-500 mb-4 flex justify-center drop-shadow-lg flex-shrink-0">
                    <!-- ここにSVGが動的に挿入されます -->
                </div>

                <!-- 物語の本文 -->
                <div class="mb-6">
                    <p id="modal-detail" class="text-gray-700 text-m leading-relaxed whitespace-pre-wrap text-left"></p>
                </div>

                <!-- セパレーター -->
                <hr class="border-red-300 mb-4">

                <!-- 日付とタイトル（物語の最後に表示） -->
                <h3 id="modal-footer-title" class="text-m font-bold text-red-800 text-center flex-shrink-0"></h3>
            </div>
        </div>
    </div>

    <!-- ロックメッセージ表示用ボックス -->
    <div id="lock-message-box" class="text-base font-bold">
        <span id="lock-message-text"></span>
    </div>


    <!-- jQueryによる動的処理スクリプトとデータ定義 -->
    <script>

        // ==============================================================
        // 【重要】アドベントカレンダー コンテンツデータ構造（ここを編集してください）
        // ==============================================================
        const ADVENT_DATA = [
            {
                day: 1,
                title: '無知なままで',
                headerText: '12月1日：🔳🩺', 
                story: `「パティさん、ダンスの相手は決めたんですか？」
「ん？なんのこと？」
　夜も更けたU FOR Uにて、在庫の確認をしていたブラック・ジャックスが、ホールの見回りをしていたパティに声をかける。

「今週末にイベントあるじゃないですか？JTS主催の。」
　パティさんも参加するって救急隊の同期に聞きましたけど。と得意の情報戦の成果を漏らす。
「あー、イベント……。うん、申し込みしたかも～。なに、あれ相手とか必要なの？」
「そりゃ、ダンスパーティですからね。」
　JTSは統率の取れた集団での踊りが有名なメカニックだ。パティは、そのダンスを見せてもらうようなイベントだと思い、面白そうだと申し込んだことを思い出した。

「社交ダンス、踊ったことないの？」
「しゃこうだんす？」
「男女でステップを踏んでムードを楽しむんですよ。」

「ほら、こっち来て。」
　ジャックスが急かすように、少し嬉しそうにパティをに手を差し出した。
　見慣れたU FOR Uのホールが二人が手を取り合った途端に、カフェからダンスホールに変化した。木の温もりに包まれて、暖炉がぱちぱちと音を立てる。ゆったりとしたOh,Jesus!のBGMを聞きながら、パティはジャックスに導かれるままホールの真ん中に進み手を取った。

　身体が密着するのもかまわず、パティは新しいことをジャックスが教えてくれるのだと嬉しそうに顔をほころばす。ジャックスは引き締まった腰に手を当て、もう片方の手を絡ませる。
「じゃあ、練習するよ。はい、いち・に・さん、いち・に・さん……」
　二人のU FOR Uの制服は、並んで立つと一枚の絵のように調和していた。

「いち。に、さん。」
　パティが小さくつぶやきながら、頭のつむじがわずかに揺れる。そして綺麗にジャックスの革靴を踏み、バランスを崩す。それを少し腕に力を入れたジャックスが支えなおす。
「あっ、ブラブラごめん。」
「いいですよ、こういうのは練習あるのみですからね。」

　しばらくすると飲み込みの速さが幸いし、軽やかにステップを刻むようになった。彼女がイベントに参加すれば、注目の的になるだろうと思うほどに。
　何度もパティの華奢なつま先が自分の革靴の上に触れる。その軽い衝動が伝わる度、ジャックスの心臓が小さく跳ねた。そして上達するほどに、その回数が少なくなるのを寂しく感じた。

　どれほどの時間踊っていただろうか、パティの一言でジャックスはハッと我に返った。
「ブラブラー、もう無理だよぉ。」
　するりとジャックスのリードから抜け出し、パティは近くのソファに座り込む。ジャックスはその様子に苦笑しながら隣に腰掛け、パティの脚を労わるための治療道具と飲み物を手渡した。
「ありがとう。練習も、付き合ってくれて。」
「いいえ、ステップの飲み込みがとても早くて、ジャックスも時間を忘れるくらい楽しかったです。」

　ぐでんと足を投げ出すパティに、再度声をかける。
「それで、誰と行くんですか？」
「えー、つんつんと行こうかなって思ってたけど、こういう感じならこみこみがいいのかなぁ。」
　スマホを手に連絡先を吟味しているであろう彼女を横目に、ジャックスは少し胸に詰まるものがあった。

「でもね、ブラブラがチケット持ってないんだったら……、今みたいに一緒に踊れたら楽しいだろうなと思って。」
　チケット持ったもの同士が行っても問題はない。しかし自分が教えたステップを、他の男と踊るであろう彼女を見るのも面白い気がした。

「ジャックスはいつでも歓迎ですけどね。」
　満足げを装いながら、胸の痞えは未だ取れない。

`
            },
            {
                day: 2,
                title: '慣らしていったってことでしょ',
                headerText: '12月2日：♨️💛', 
                story: `　ロスサントスの住人には関わりのある人とない人の差が激しい。
　ただ、どんな住人でも可愛いは正義である。とゆたんぽは考えている。

　例えば、救急隊では滅多に見ないが、BMCによく訪れる羽山パティさん。
　パティの経歴をゆたんぽは詳しく知らない。ただ、ギャング、個人医、半グレすべてに。つまり、黒市民であるということだけが確定している住人だ。

　しかしそのような経歴は、ゆたんぽにとっては些細な事だった。
　病院や犯罪現場では遠目からしか見れなかったパティと、BMCで出会った時には胸が躍った。

　きめの細かい白い肌、さらけ出された脚は程よく引き締まり、小さな顔には宇宙を閉じ込めたような大きな瞳。その快活そうな全体像に見合う明るい笑顔。そして白でも黒でも関係なく、周囲を温かくしてしまう魅力。
　まさに『かわいい』の定義に当てはまる住人といえるだろう。

「ぶーん、あっ、んぽんぽ！修理お願いします。」
　いつも通り狐さんを助手席に乗せて、ゆたんぽが勤務中のBMCに車をガレージに入れる。そして二人が車から降りる。
　その隙を狙って他の住人にやっているのと同じく、彼女に『ぎゅっ』とハグをする。

　その瞬間に、彼女の身体が固まったのを回した手で感じた。
　色々な人と仲が良く、特に仲の良い人とはよくおんぶや抱っこをしてもらって笑っているのを見ていた。しかし軽い一方的なハグでこれほど警戒されることに、あぁ、そういうことかと理解した。

　彼女が『心』を許さねば、本当は触れることは『脅威』になりうるのだろう。それほどの過去が積み重なって彼女を形成している。
　そしてこれ以上追求しようものなら、隣を当たり前の顔で立っている狐さんが『黒』としての対応をするのだろうことは容易に想像できる。

　『普段通り』、一方的に背中に回していた手を戻して、何も悟られないように声をかけた。
「パティさん、今日もかわいいですね！」
「知ってるよ～！」　
　かわいらしい返事とともに、ほかの従業員がやってくれた修理にお礼を言う行儀のよさ。羽山パティが白市民であれば、いつか自分を受け入れてくれるように、もっと優しく深くゆっくりと関わりたいと思ったことは一度ではない。
　そんな日は来ないことを知りながら、ゆたんぽは笑顔の仮面をつけていつも通りを装う。
「いってらっしゃーい！狐さんも！！」

`
            },
            {
                day: 3,
                title: '君がいい',
                headerText: '12月3日：🚬🦊',
                story:`　ここロスサントスには四季のようなものがある。
　春になればピンクの花をつけた木が並び、公務員は花見と称して酒を飲む。
　夏になれば木々は青々と、日差しの強い日が多くなり、ブティックには水着や浴衣が並ぶようになる。
　秋になれば葉は茶色くなり、地面には掃いても掃いても落ち葉がたまる。
　そして冬には、突然雪が訪れる。

「こみこみ～！」
　魔女の酒場の前のレンガ造りの広場で自販機を回る準備をしていた小峯に、聞きなじみのある鈴のなる声が遠くから聞こえた。
　雪の積もったロスサントスは普段の喧騒が嘘のように静まり返っており、彼女の声はまっすぐ小峯に届いた。

「おはよう、パティ。」
　荷物を詰めている手を止めて、走り寄ってきた彼女の頭や肩に積もった雪を払いながら挨拶をする。
「おはよ～！雪だよ！！」
　……見ればわかることではあるが、パティは新しいおもちゃを見つけたとばかりにきらきらとした瞳で見上げてくる。得意げにふんと吐き出された息が白く、早く温かいところに移動させたい気持ちが勝った。

「あー、そうだね。雪だね。そんなに脚出して寒くないの？いったん店入るか？」
　小峯を知る他の人間が見れば、確実に『過保護』であり、『彼らしくない』言動だが、小峯とパティの場合は日常で行われる挨拶の一部に過ぎない。
　彼の心配をよそに、パティの視線は小峯の頭上に向けられていた。その視線に気づき、首を傾げる。
「どうかしたか？」
「あっ。」
　小さな声とともに、パティは小峯の頭に手を伸ばす。警戒心の高い小峯が、いとも簡単に身体を触ることを許してしまった。

「あー、パティもトントンってしたかったのに。」
　恐らく先ほど首を傾げたことで、頭に積もっていた雪が落ちたのだろう。
　二人の身長差では頭に手を回すことはできなかったものの、彼女の手は無意識に近づいていた小峯との距離を表すように目の前にあった。もう少しだったのにとばかりに名残惜しそうに、彼の前髪を少し分けるように指を動かす。
　額にヒヤリとした細い指の感触が伝う。思わず小峯がパティの手を包んだ。
「おい、寒いんだろ。中はいるぞ。」

　小峯の手にすっぽりと収まる冷たい手を引いて酒場に入る。
　薪が燃える暖炉のぱちぱちという音、ふと薫る木の温もり。階段を下りるごとに冷えていた指や鼻に温度が宿る。
　服に付着していた雪が解けたようで、露出していた部分よりも服を着ていた部分のほうが、じわじわと外の寒さを伝えるように身体に染み渡ってきた。

　ふるり、パティが腕をさすりながら暖炉にすり寄る。
　そんなパティに大き目のタオルを渡す。
　クローゼットを漁りながら、小峯は自分の着替えと、パティが着れそうな着替えを探し、そのうちの一つに目を止めた。
「はい、これ。着ないよりましだろ。服、着替えときな。」
　タオルで髪の水気を拭いていたパティの近くに、着替えを置いておく。

　小峯も適当な服を選んで手早く着替える。
「パティ、どうする？着替えたら自販機、一緒に行く？」
「うん！」
　どうやら挨拶をしてきただけの予定が、パティの中で『今日一緒に活動すること』になったようだと、小峯は今日の予定を少し組みなおす。

「背中向けとくから、着替えたら教えて～。」
「はーい。」
　気の抜けた返事を背中で聞き、即座にもぞもぞと布が擦れる音が聞こえる。
「警戒心って、ご存じ？」
「んー？」
　小さく呟いた言葉が届いたのかはわからないが、小峯が口を開いたことだけはわかったらしい。パティには実際小峯の言葉が届いていたが、『彼だから』警戒心が必要ないことを彼女は知っていた。

　しばらくの静寂の後、着替えを終えたパティが『ふわぁ』と息を漏らす。
「懐かしい！！」
　小峯に歩み寄り、目の前でふわりと懐かしい茶髪が靡く。
「んふふ、やっぱりこれ可愛いよね～。」
　紫のタートルネックに、黒いデニムのオーバーオール、足元をヒールで着飾り、今でもお馴染みの犬耳。そして変装用の黒いマスクと落ち着いた色の頭髪。IRiSでの彼女の戦闘服だった。

「あー、……。」
　渡したのは何となく、目についたからだった。これなら長袖で露出もなく、パティが酒場に残していった服の中で暖かそうだと思ったから。
　実際に彼女が着ると、なんとも言葉にしがたい郷愁のような、胸が締め付けられる思いが込み上げてきた。一瞬、声が喉の奥で凍り付き、手の甲で口元を覆う。

「こみこみ、どうしたの？自販機行く？」
「……あぁ。」
　外に出ると先ほどよりも大きく柔らかい雪が、上からも横からもふわりふわりと二人の周りを舞う。そのため、二人が車に乗ったころには着替えた甲斐もなく真っ白だった。
　二人で顔を見合わせると、頭に白く積もった様子がいつもパティの金髪ではわからなかったが、小峯と同じだけ積もらせていた。
　小峯がふっと笑い、パティの頭に手を伸ばすのと同じタイミングで彼女も自分に向かって手を伸ばしていた。

「綺麗だね！！」
「……そうね。」
　パティの通る声が雪に吸収されて、自分にしか聞こえなくなればいいのに。複雑な気持ちになったのは口に出せないままで。


                `
            },
            {
                day: 4,
                title: '静かな寝息',
                headerText: '12月4日：🦗',
                story: `　クリスマスシーズンのU FOR Uはとにかく色々なお客で賑わっていた。
　白も黒も関係なく、誰でも気軽に立ち寄れる。けれど、どこか大人びた空気の漂うカフェ＆バー。
　そんな店がクリスマスフェアと称してVIPルーム専用のデザートを作り、一般用でも季節限定のメニューが数多く並べ、内装を飾り付けている。その機会を逃してなるものかと、ロスサントスの街にいるカップルや、職場への差し入れ、はたまた映えを狙って。様々な理由で常に賑やかな店内を、今日はパティとゴンが回していた。

　パティが注文を取り、ゴンが調理をして余裕のある方が配膳をしていく。
　お客に対して従業員は明らかに不足していたが、長年の付き合いでお互いの息の合わせ方を心得ている二人には好都合だった。
　何も言わずとも差し出される商品と、遠くからわかるように読み上げられる注文。
パティは店員としての接客態度をいつも通り変えず笑顔で対応し、ゴンは持ち前のストイックな性格でホールで行われている注文を背中で受け取り、商品を作る作業を続けた。

　人が途絶えたタイミングをいいことに、疲れたパティが閉店ツイートを投稿し、U FOR Uは無事本日の業務を終えた。
「ふぃー、パティもう限界。疲れた～。」
　ぽすん、三人掛けソファに飛び込み、仰向けになり伸びをする。
「うーん、もう動けなーい。」
「パティ、閉店作業しよ？」
「ちょっとだけ、休憩したら……。」
　そういいながらも語尾は弱く、すでに眠りの世界へ飛び込んでいったようだった。どうやら本当に限界だったらしい。

　ゴンは毎日働いているわけではないが、オーナーの家族ということで、パティはできるだけ家族の居場所であるこの店を開けようと意識していることはわかっていた。
　飲食店は従業員一人いれば開店できるが、来る客の予想は全くつかないのがこの街だ。
　もともと評判の良い店が開いていれば、自然と人は集まってくる。パティは一人であっても、そのすべてを器用にさばいているのだろう。

　あまり音をたてないようにキッチンとホールの清掃を済ませ、パティを見るとソファに身を預け、横向きに寝ていた。接客の張り付けた笑顔はそこにはなく、きれいに流されている金髪が少し顔にかかり、桜色の唇が少し開いていた。瞼の下には、薄い影。
　それでも、どこか安心している顔だった。
　完全に無防備な姿をさらされ、ゴンはパティをまじまじと見てしまったことに謝罪したくなったが、その相手は今夢の中。

　視線を切り、キッチンの奥にある仮眠室から毛布を取り、パティの脚が冷えないように肩までしっかりと覆う。
　これほど疲れているパティを見たのはいつぶりだろうか。

　毛布をかけながら、ふとゴンの脳裏に過去の光景が蘇った。思い返せば、パティとの思い出はいつだって彼女の笑顔と笑い声で溢れていた。
　自分が何を言っても笑ってくれる、即興で考え付いた遊びだって大喜びで一緒にやってくれた。
　大型犯罪も、一日にどれだけやっても彼女が弱音を吐いたり、疲れた姿を見せることは無く、むしろ喜んでいたように見える。

　……自分がIRiSを脱退する際は、彼女は泣いていた。笑いたいのにと言いながら、止まらない涙を拭くこともさせてあげられなかった。
　笑いたいのにと茶目っ気を見せたがる言葉の奥に、どれほどの苦労があったのか。当時の自分は、気付けなかった。

　そこまで記憶をさかのぼると、パティは疲れ知らずという面もあるが、いつも周りに気を使って疲れを見せないようにしていた場面は少なからずあったのだろうと感じた。
　そして、自分はいつもそれに気付けなかった。

　クリスマスに渡そうと思っていたプレゼントを手に取った。
　犬カフェの限定ポーチに彼女に似合うと思ったヴァイオレットフィズのリップ、そして各所に頭を下げて頼んだ今までのパティの限定商品。

　クリスマス当日にこの街にゴンがいられるかはわからなかったが、パティの思い出を忘れたくなくて、忘れられたくなくて。ずいぶんと前からギフトボックスを持ち歩き開けては閉めてを繰り返していたため、ギフトボックスは少しよれていた。

「いい子には、ご褒美が必要だから。」
　ゴンはそれをソファの前にあるローテーブルに置き、顔にかかった髪の毛を耳にかける。
　すると少しパティが身じろぎをして、長い睫毛から薄く輝く瞳を見せた。
「ゴンゴン？」
「パティお疲れ。閉店作業やっといたから、あと帰るだけだけど、どうする？今日はここで寝るの？」

「んーん。オザオザの家に帰らなきゃ。」
　そう言って重たそうに身体をあげたパティから毛布を受け取り仮眠室に戻す。
　しばらくすると、ローテーブルに気づいたようで、あっと小さな声が上がる。
　ギフトボックスを指さしながら深い宙色を丸くしてゴンの方を向いた。
「これ、ゴンゴンがくれたの？」

　ゴンはパティが起きたことが予想外だったため、とっさに隠せなかった自分を悔やんだ。
「あー、そうだね。パティすごく頑張ってたから、ちょっと早いけどクリスマスプレゼント。」
「……うれしい。」
　眠気の残る声でそう言いながら、箱を抱えて笑う。その小さな笑顔が、ゴンには少しまぶしかった。

「開けてもいいの？」
「さすがに、ちゃんと家帰ってからにしよ？もう眠たいでしょ。」
　いつも通り、パティへのプレゼントは量が多くなってしまうのだ、今開けられるとパティが寝る時間が遅くなってしまうと思い、ストップをかけた。

「わかったー。ゴンゴン一緒に帰ろ。」
　両手を伸ばして子供のように抱っこ待ちする彼女に苦笑しながら、当然のようにお姫様抱っこをする。
　服装は制服のまま、店舗のカギを締め、自分の車の助手席にパティを座らせて発車した。
　同じ家に帰る二人を、止めるものは何もない。
　ロスサントスの夜は、静かに雪を待っていた。


`
            },
            {
                day: 5,
                title: 'コバルトブルーへの対抗心',
                headerText: '12月5日：🐕🛸',
                story: `「パティは最近なんか欲しいもの、ないの？」
　リビングでパティが椅子に腰かけスマホを見ていると、家に帰ってきたアヌギフが冷蔵庫の中身を確認しながら声をかけた。
「んぇ？」
　家にいるときに会話が発生することは珍しくないが、アヌギフから話を振ってくることは稀で、まして彼から欲しいものを聞いてくるとは思いもよらず、間の抜けた声がパティの口から漏れた。

「ほら、そろそろクリスマスじゃん。なんか欲しいものないのかなって。」
　パティが継ぐ言葉に困ったのかと思ったアヌギフは少し早口で説明を入れた。
「んー、そうだなぁ。貰えるなら何でもうれしいけど……。」
　持っていたスマホをテーブルに置き、顎に人差し指を添え、少し考える。

「でも急にどうしたの？」
　パティはアヌギフがお金に困っていることは何度か見たことがあったが、積極的に人に何かを与える場面に遭遇したことはあまりない。
　核心を突かれたアヌギフは落ち着きなく何度も開け閉めしていた冷蔵庫を閉じて、少しうつむき首の後ろに手を持っていく。その仕草はパティがよく見るアヌギフの照れ隠しだった。

「前、科場さんにさ、ねだってたから。」
　ぽつり、下を向いて告げられた言葉は大きなものではなかったが、アヌギフの方を向いていたパティにはしっかりと聞き取れた。
「欲しいもの多いなら、俺でもちょっとは買えるからさ。」
　甘い言葉を吐くわけでもなく、ただ不器用な言葉を集めて繋げたような発言だったが、パティは兄が何を言いたいのか理解した。

「んへへ、あのね、もろもろには今度一緒に出勤するときに送って欲しいって、おねだりしてたの。」
　内緒話をする子供のようなまなざしで、吐息を含ませて小さく紡いだ言葉に、アヌギフは街でのパティを家族の中では一番知っている自負があったため意外に思った。
　彼女は誰よりも強かに、貰えるものは当たり前に、欲しいものは誰かにねだるような。そんな生き方をこの街では基本にしてきたはずだった。
　運転手、しかも同じ屋根の下で生活している人間に。ただのかわいいおねだりだった。
「運転が慣れてきたって話、聞いたからさ。」
　嬉しそうに、主のいない部屋に視線を向けたパティ。ある儀式によって片目を失いながらも『生きる』ことを選択してくれた科場。彼への心配半分、甘えたい半分を適切なバランスで、彼女は『必要』を伝える。自分のどこまでも無関心な心のどこか、知らないところが温かくなった気がした。

「だからさ、パティ、アマギフからも何か欲しい、とかはないんだけど。……いつものモーニングコール実はうれしいからさ、あんまり時間取れないけど、もっといっぱい話そ？」
　いつの間にか身体までアヌギフに向けていたパティがこちらに視線を移して首を傾ける。その耳元はおねだりに慣れていない無垢な少女のように赤らんでいた。この街の生きざまと異なる『家族』の姿にアヌギフは何も考えず「いいよ。」と答えていた。

「あとねあとね、もう今日パティ疲れちゃったから部屋までおんぶして～。」
「はいはい。」
　あの美しい青に芽生えた微かな対抗心さえ甘さに変えてしまう妹に、アヌギフはやはり兄にも、妹にも敵わないことを知った。いや、知っていた。

　たまに不安になる。科場に双子が頼り、その期待に応える兄。自分も双子の兄であることを自覚し、頼られていないことに不安が募り車などをあげてみるがしっくり来ていなかった。
　本人に欲しいものを聞くと、『自分』が必要だと伝えてくれる家族に、アヌギフはこの日々の愛しさを感じていた。

`
            },
            {
                day: 6,
                title: 'キッチンに並ぶ',
                headerText: '12月6日：🦖',
                story: `「おはザウ～、パティどこいるの？」
『おはザウ～！今日はね、U FOR Uいるよ！』
「オッケー。」
　短いやり取りで、柳瀬つんの向かう先は決定した。

　営業時間外のU FOR Uの重厚な扉は、外の世界を拒むように固く閉ざされている。部外者を一切受け付けない、あの家族と同様に。
　けれども、つんは迷いなくドアノブを捻る。まるで扉に鍵が開いていることを確信しているように。

「パティパティおはよー。」
　パタパタと廊下を進むつんに、すぐそばから声が返ってくる。
「おはよー。」
　パティはつんの予想より近くにいた。

　彼女はいつものカウンターではなく、ホールにある二人掛けの革張りのソファに座っていた。目の前のローテーブルにはいくつかの紙袋。そして膝に乗せた雑誌のようなものと睨めっこをしていた。

「何見ているの？」
　隣に腰掛け、彼女の眉を顰める原因である膝の上を覗き込む。
　そこには、かわいらしいラッピングされた箱と、その中身であろうお菓子の写真が大きく並んでいる。レシピ本だった。

「んー？うん。なんかクリスマスっぽいもの作りたいなって思ったの。」
　目線を本から離すことなく、細く白い親指と人差し指がページをめくる。
「そっか。何作るの？」
　パティの思い立ったらすぐ行動、という性格をよく知っているつんは、特に疑問も覚えることなく話を続ける。

「それがね、決まらなくって～。」
　ぐでん、と膝に本を乗せたまま、パティはソファの背もたれに向かって伸びをした。
「もうつんつん決めちゃってよ。」
　本をぐいぐいとつんに押し付けながら、パティは深くソファに凭れかけていた身体をつんに向けた。
　その瞳はようやくつんに向けられた。

　彼女に押し付けられた本を胸に抱く。そっとローテーブルの空いている部分にそれを広げる。
　興味深く一つ一つのページをめくりながら、つんはパティも好きそうなお菓子を見つけては声をかける。

「この木みたいなやつ、おしゃれじゃない？」
「ブッシュドノエル？……甘そう。」
「確かに。」

　別のページを開く。
「じゃあこれは？なんか見たことない形のやつ。」
「クグロフ？……ちょっと地味かも？」
「だよなぁ。」
　生地自体はシンプルそうに見えるが、アイシングや粉砂糖などクリスマスに合わせてデコレーションをすると、甘いものが苦手なパティには合わないかもしれない。

　そうした問答を繰り返しながら、パティとつんは頭を寄せ合い考え、気付けば残りのページが少ない感触が本を抑えている指から伝わる。
　つんは少しそわそわした。せっかくパティが材料まで買ってきたのに、決まらないのはもったいない気がして。

　しかし、次のページで二人の声が揃った。
「「あっ。」」

「これやね。」
「これにしよ。」

　二人で紙袋を移動させながら、準備を始めようとしたつんは、ふと自分の身体のサイズを思い出す。
「ちょっと待ってて、着替えてくる。」
「着替え？」
「あっ、いや、人間になってくる。」

　んふふ、と悪戯心を含んだ笑いを背にパタパタと、クローゼットまでの道を急ぐ。
　作業のしやすい服を着た人間の姿になると、自然と歩幅がいつもより大きくなり、ゆったりと歩いてキッチンに向かう。

　キッチンではすでにパティが紙袋から必要なものを出して指さし確認をしていた。
「よし、やるか。」
「やるか！」
　つんが袖をまくると、パティも真似して袖をキュッと上げる。

　レシピを見ながら、パティが出した材料をつんが量っていく。
　途中で粉まみれになるようなトラブルはあったものの、無事に生地をこねて伸ばして、型抜きまで作業を進める。
　生地をオーブンに入れた瞬間、二人で「ふぃー」と同時に息をついた。

　片付けをしていると、甘さの奥にピりッとした香りが漂う。
　隣のパティが大きく息を吸ったことがわかり、くはっと笑ってしまう。
「もー、笑わないで！いい匂いなんだもん！！」
「そうやね。俺もピンときたもん、ジンジャークッキー。」

　楽しみを表すように、二人は元居たソファではなく、焼き時間をキッチンの丸椅子で話ながら過ごした。時折オーブンを気にしているパティを見て、つんもなんだか楽しくなった。
　焼きあがった音が二人だけのホールにやけに響いた。パティがすぐさま立ち上がり、わくわくした様子でオーブンの前に立つ。

「ミトンどうする？持つ？」
「んー、つんさんに任せます。」
「ふは、はい、任されました。」
　パティが場所を譲ったので、ミトンはそのままつんの手に。

　皿をカウンターに並べ、焼けたクッキーを慎重に移していく。端のほうの焼き色はちょっと濃い気もした。しかし気になるほどではなく、これは成功したな、とつんは少し胸を張った。

　早く食べたがるパティを抑えつつ、チョコペンの準備をして粗熱の取れたクッキーに二人で顔をつけていく。
「見て見て～、これ、つんつん。」
「くかっ、全然似てねぇ。こっち見て、パティ。」
「くかっ、つんつんの方が似てないじゃん！！」

　二人で作ったクッキーを見せあいながら、それぞれがデコレーションを施したものを試食した。
「……ちょっと硬いかも？」
　首を傾げるパティにつんも、同意を示す。
「……結構硬いかも？今なら刀食えるくらい。」
　ゴリゴリと、触感の良すぎるクッキーを二人で必死に飲み込む。

　飲み込んだところで、爆笑が二人を包んだ。
　生姜のスパイシーな香りは、甘さを引き立たせとてもおいしかった。
　そして二人で涙が出るほど笑ったこの時間も、とても甘い思い出になるだろう。

「なんかこれ、逆にエモくね？」
「エモいね。このクッキー。」
　ぴよぴよと限界まで笑い合いながら、もう一つもう一つと確実に減っていくクッキーに、つんとパティはおなかも心も満たされた。

`
            },
            {
                day: 7,
                title: '黒の背徳と秘密',
                headerText: '12月7日：🐗',
                story: `　SKEから出ていこうと、修理の終わったバイクに跨るパティに声がかかった。声の主はほかでもない、先ほどまで愛車の手入れをしてくれていた猪狩だった。
「パティパティさ、これ。」
　整備用のグローブを脱ぎ、つなぎのベルト部分に挟み込みながら作業台へ向かっていく。再度こちらへ向かってきた時には、その手のひらに小さな黒い箱が乗せられていた。
「はい、どうぞ。」
「ありがとう！」
　意外な人物からの贈り物に、パティは嬉しそうに顔を綻ばせる。
　小さな黒い箱がパティの両手に乗せられる。
　
　箱を一心に見ているパティに、猪狩は苦笑しながら手を重ねるようにして蓋を開ける。
「ほら、中身見ないと、それはただの箱だからさ。」
そこから出てきたのは箱の雰囲気と同じ黒い輝きを持った一つのピアス。
シンプルで、周りの装飾がないことで夜そのものを小さく切り取ったような石が主役であることを引き立てていた。
「えっ、ピアス？……めっちゃ可愛い！！」

　ネオンの明るい店内で、パティは箱を掲げ、くるくると回る。その手の中の一粒の黒は、角度によって暗い宙色の瞳を映し、また別の角度ではネオンのピンクを石の奥から返した。
「確か、オニキス？って店の人が言ってた気がするけど。結構いいなって思って。」
「いがいがが？」
「うん。」
「なんでパティに？」

　猪狩が気に入ったものを、猪狩のために買うのではなくパティに買ってくれたことに違和感を覚え、思ったままを口に出すパティに猪狩は当然のように返す。
「だってパティパティ最近穴開けたでしょ？」
「よくわかったね。」
「開けたんだなって思って、化膿とかしてたら痛いでしょ。俺個人医だからさ。」
「んふふ、さすがだぁ。結構髪の毛で隠れるんだけどね、ちょっとだけ、気分転換に開けてみたんだぁ。」
　嬉しそうに、誇らしげに隠れていた耳をさらすように、おろしていた髪の毛を少し耳にかける。そこには、セカンドピアスなのか繊細なデザインのシルバーが飾られていた。

　恐らく誰かからの贈り物を無碍にすることなく、つけるために穴をあけたのだろう。人の好意を素直に受け取るその姿勢は好ましいと常に思っていたが、この街でタトゥーやピアスをしない黒市民は、もしかしたら白市民を含めても珍しいかもしれない。
　そんな綺麗な肌に、自ら傷をつけたという事実に、言葉にはできない胸のざらつきが残った。

　猪狩はパティがIRiS時代からペティとパティを見分け、悪戯で入れ替わった時にもメンバーの誰よりも早く気付くことができるほど二人をよく見ている。
　そのため、パティにピアスホールができたことを知っていた。そして、トラブルが起こっても対応できるように構えていた。
「気分転換ね。それでピアスできるようになったんだなって思って。自分の見てたらいいのが見つかったからさ。」

　ほら、と指を差した先は自分の口元。
　黒地に銀の装飾がついたマスクはIRiS時代から猪狩が変わらずつけているものだ。
　そして、パティが犯罪をするときに使っていたマスクも同じものだった。
「俺と結構好み似てるから、多分気に入るかなって思って。」

　今はもうできない服装の思い出が、パティの中で温かく蘇ってくるのを感じた。
「そうだった！パティIRiSの時さ、いがいがとお揃いだったんだよね～。」
「ねー。」
　黒、という色から連想される猪狩との思い出が、今でも続けられる気がして、それを猪狩から持ってきてくれたことがうれしくて、パティは箱を手に取った時より大きな声で言った。
「ありがとう！いがいが！！」
「どういたしまして、パティパティ。」
今度こそバイクに跨り、SKEを出ていくパティを見送る。

　猪狩のマスクの奥、長い髪で隠れた耳にはいくつかピアスホール。そのうちの一つに、パティと同じ黒い石が、静かに光を吞んでいた。

`
            },
            {
                day: 8, title: '来年を約束する',
                headerText: '12月8日：🚬🦊',
                story: `　地上で扉の開く音がした、外気の寒さが店内に細い線のように流れ込む。
「ぶーん、きたー。」
　勢いの良い彼女は外の寒さを纏ったまま、来店した。
　気の抜けた来店報告に小峯は顔も上げずに、歓迎の意思を示す。
「いらっしゃい、パティ。」

　在庫を作る手を止めて、ウェルカムドリンクと小皿をパティに提供する。
　提供したときに見た彼女の顔は、鼻を赤らめ、外の寒さを物語っていた。
　小峯の正面にいたパティは、初めて見る小皿を、皿の上に乗るラスクのような、ケーキのような存在を見て、首を傾げる。
「こみこみ、これ何？」
「これはシュトーレンやね。」
「……シュトーレン。」

　皿に乗った、薄いパンは想像よりも柔らかく、パティの親指と人差し指でつまむと形を変えた。
　そのたびに、砂糖であろう白い粉が皿の上に雪のように降り積もる。
　その仕草が妙に幼く見えて、思わず笑ってしまう。

「こら、食べ物で遊ばないの。」
　興味津々で観察していたパティは、ハッと小峯の声で気づいたように手遊びをやめ、小さな一口を味わった。
「んー、ふーん、パンだ。ちょっと大人な感じだね。」
　嬉しそうに顔をほころばす彼女に、小峯も安堵しながらシュトーレンについての説明を続ける。

「酒が使われているからな。大人な感じ、っていうのはあってるかもな。」
「保存食になるように材料や保存方法は気をつけられてるんだよ。」
　ふぅ、と小峯が息を吐く。

「えっ、こみこみが作ったの？」
「いんや？これはパン屋のやつ。こんな手間がかかる菓子、俺が作ると思いますか？」
「んふふ、そっか。だりぃ～ってなっちゃうもんね。」
　パティが少し沈黙を挟み、よいことを思いついたとばかりにきらきらとした瞳をあげた。
「じゃあ来年、パティがつくろっか？こみこみの顔より大きいやつ！！そしたらみんなでいっぱい食べれるからさ。」
　彼女の提案に、小峯の作業の手が一瞬止まった。
　いつ終わるのかわからない関係、街において、『来年』という言葉は重たく感じた。
　ただ、それを一番実感しているパティが自らその言葉を使ったことに、驚きを隠せなかった。

　ふっと肩の力が抜け、ほんのわずかに彼の口角が上がる。
　仕方ない子供を見るような、愛しいものを見る瞳だ。
「……保存がきくやつにしてくれ。どうせ俺が一番起きてるんだから。」
「うん！」

　その後もクリスマスになるまで、毎日提供されるシュトーレンを楽しみにパティは魔女の酒場に向かう。

「ぶーん、とうちゃーく。」
「いらっしゃいパティ、シュトーレン、味しみてきて甘くなってたよ。」
「えー、楽しみ！！」
　二人で同じものを食べ、日々変わる味を共有できる期間限定の小皿。
　それの味のなじみとともに、二人は優しさに包まれる。

　パティが零した未来への約束を胸に灯して、小峯は年甲斐もなく期待を抱えてしまった。
「ま、覚えてるかわからないけどな。」
　自分で保険を掛けながら、そっとつぶやくが、それすらも彼女は拾ってしまう。
「ん？忘れないって。任せてよ～。」
「ふっ。」

　魔女の酒場の暖炉が、二人の温かさが、来年も続くことを無意識に祈ってしまった。

`
            },
            {
                day: 9, title: 'その手を止めないで',
                headerText: '12月9日：✌🛸',
                story: ``
            },
            {
                day: 10, title: 'あったかいアイスVer.G',
                headerText: '12月10日：🦗',
                story: ``
            },
            {
                day: 11, title: '心の温度を映す',
                headerText: '12月11日：🦖',
                story: ``
            },
            {
                day: 12, title: '温度は見つからない',
                headerText: '12月12日：❤️🕶',
                story: ``
            },
            {
                day: 13, title: '『君』を知る',
                headerText: '12月13日：🕶🏍',
                story: ``
            },
            {
                day: 14, title: 'アトリエ',
                headerText: '12月14日：🐈💜',
                story: ``
            },
            {
                day: 15, title: '色を揃える',
                headerText: '12月15日：🚬🦊',
                story: ``
            },
            {
                day: 16, title: '特効薬をどうぞ',
                headerText: '12月16日：🦖',
                story: ``
            },
            {
                day: 17, title: '特別内緒なブレンド',
                headerText: '12月17日：🛠️📷',
                story: ``
            },
            {
                day: 18, title: '毎日をあげる',
                headerText: '12月18日：🍆',
                story: ``
            },
            {
                day: 19, title: '蓋をする',
                headerText: '12月19日：🚬🦊',
                story: ``
            },
            {
                day: 20, title: 'CuteとGood',
                headerText: '12月20日：🚬🦊',
                story: ``
            },
            {
                day: 21,
                title: '知らないところで',
                headerText: '12月21日：🕶🐦‍⬛',
                story: ``
            },
            {
                day: 22,
                title: 'あったかいアイスVer.O',
                headerText: '12月22日：🍆',
                story: ``
            },
            {
                day: 23,
                title: '色を纏う',
                headerText: '12月23日：🍙🛸',
                story: ``
            },
            {
                day: 24,
                title: '',
                headerText: '12月24日：🦖',
                story: ``
            },
            {
                day: 25,
                title: '',
                headerText: '12月25日：🚬🦊',
                story: ``
            }
        ];
        // ==============================================================
        // 【重要】日付制限ロジック
        // ==============================================================
        const today = new Date();
        const currentMonth = today.getMonth() + 1; // 1月が0なので+1

        // 12月の場合のみ今日の日付を使用。それ以外の月は0日（全てロック）
        let currentDay = (currentMonth === 12) ? today.getDate() : 0;

        // デモ/テスト用: 動作確認のため、常に12月10日として扱う（1日～10日が開けられる）
        // 実際に12月になったら下の行をコメントアウトしてください。
        //currentDay = 8;

        // デモ用日付を画面に表示
        document.addEventListener('DOMContentLoaded', () => {
            const dateInfo = document.getElementById('date-info');
            if (currentDay > 0) {
                dateInfo.textContent = `[12月${currentDay}日]`;
            } else {
                dateInfo.textContent = `[12月ではないため全てロックされています]`;
            }

            // DOMContentLoaded時にカードを生成する
            generateCalendarCards();
        });
        // ==============================================================

        // カード生成関数
        function generateCalendarCards() {
            let cardsHtml = '';

            // プレゼント箱アイコンのSVGパスを定義
            // 閉じたプレゼント箱 (ロック状態) - Lucideのgiftアイコンを基に
            const closedGiftSvg = `
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12v6a2 2 0 01-2 2H6a2 2 0 01-2-2v-6m0 0h16M4 12v-2a2 2 0 012-2h12a2 2 0 012 2v2M12 4v16M9 4h6"/>
                </svg>`;

            ADVENT_DATA.forEach(data => {
                const day = data.day;
                // 日付制限のチェック
                const isLocked = day > currentDay;

                // ロック状態に応じてクラスと属性、コメントを設定
                const lockClasses = isLocked ? 'opacity-50 cursor-not-allowed grayscale shadow-none transform-none' : 'hover:shadow-red-400/50 transition duration-300 transform hover:-translate-y-1';
                const lockedAttr = isLocked ? 'data-locked="true"' : 'data-locked="false"';
                const statusComment = isLocked ? 'Wait!' : 'Open!';

                // data-image-urlとdata-image-styleはデータ構造からそのまま取得
                const imageStyleAttr = data.imageStyle ? `data-image-style="${data.imageStyle}"` : '';
                const specialClasses = day === 'border-b-4 border-red-300';


                // アイコンの選択ロジック
                let iconHtml = '';
                if (isLocked) {
                    // ロックされている場合は閉じたプレゼント箱
                    iconHtml = closedGiftSvg;
                } else {
                    // アンロックされている場合は開いたプレゼント箱
                    iconHtml = "🎁";
                }

                cardsHtml += `
                    <div class="day-card bg-white p-4 sm:p-6 rounded-xl shadow-xl ${specialClasses} ${lockClasses}"
                    data-day="${day}"
                    data-title="${data.title}"
                    data-header-text="${data.headerText}"
                    ${lockedAttr}>
                        <h3 class="text-4xl font-extrabold text-red-800 text-center mb-2 leading-none z-10">${day}</h3>
                        <p class="text-xs text-gray-500 text-center mb-4 z-10">${statusComment}</p>
                        <!-- アイコン (飾り) -->
                        <div class="flex justify-center text-amber-400 z-10">
                            ${iconHtml}
                        </div>
                    </div>
                    `;
            });

            $('#advent-calendar-grid').html(cardsHtml);
        }

        // ロックメッセージ表示関数
        let messageTimeout;
        function showMessage(message) {
            const $box = $('#lock-message-box');
            $('#lock-message-text').text(message);

            // 既存のタイムアウトをクリア
            clearTimeout(messageTimeout);

            // メッセージを表示
            $box.addClass('show-message');

            // 3秒後に消す
            messageTimeout = setTimeout(() => {
                $box.removeClass('show-message');
            }, 3000);
        }

        // DOMの準備が完了したら実行
        $(document).ready(function () {

            // ===============================================
            // 1. 特徴カード（アドベント扉）のクリックで詳細モーダルを表示する機能
            // ===============================================
            $('.day-card').on('click', function () {
                const $card = $(this);
                const day = parseInt($card.data('day')); // dayを数値として取得
                const isLocked = $card.data('locked') === true || $card.data('locked') === 'true';

                // ロックチェック: ロックされている場合は処理を中断し、メッセージを表示
                if (isLocked) {
                    showMessage(`12月${day}日に開きます！`);
                    return;
                }

                // ADVENT_DATAから該当する日を探す
                const contentData = ADVENT_DATA.find(item => item.day === day);
                if (!contentData) {
                    console.error(`Day ${day} のコンテンツが見つかりません。`);
                    return;
                }

                // 以下の処理はアンロックされている場合のみ実行されます
                const title = contentData.title;
                const headerText = contentData.headerText; // NEW: ヘッダーテキストを取得
                const story = contentData.story;

                const $modal = $('#feature-detail-modal');
                const $contentBox = $modal.find('.modal-content-box');


                // ----------------------------------------------------
                // テキストコンテンツの更新
                // ----------------------------------------------------
                $('#modal-header-text').text(headerText); // NEW: 大きなヘッダーを挿入
                $('#modal-detail').text(story);
                $('#modal-footer-title').text(title);

                // ----------------------------------------------------
                // モーダルの表示とアニメーション (手紙が飛び出すフリップ)
                // ----------------------------------------------------

                // 1. モーダル背景をすぐにフェードインで表示 (オーバーレイ)
                $modal.fadeIn(200, function () {
                    // 2. モーダルコンテンツの初期状態クラスを削除し、終了状態クラスを追加
                    $contentBox.removeClass('modal-start-state').addClass('modal-end-state');

                    // モーダル表示中は背景のスクロールを禁止
                    $('body').addClass('overflow-hidden');
                });
            });

            // ===============================================
            // 2. モーダルを閉じる共通処理
            // ===============================================
            const closeModal = function () {
                const $modal = $('#feature-detail-modal');
                const $contentBox = $modal.find('.modal-content-box');
                // スクロールコンテナを取得してリセットする
                const $scrollContainer = $modal.find('.overflow-y-auto');

                // 1. アニメーション逆再生 (フリップして奥に消える動き)
                $contentBox.removeClass('modal-end-state').addClass('modal-start-state');

                // 2. CSSアニメーションが終わるのを待ってから（0.6秒後）、背景をフェードアウト
                setTimeout(function () {
                    $modal.fadeOut(200, function () {
                        // 背景のスクロール禁止を解除
                        $('body').removeClass('overflow-hidden');

                        // コンテンツをクリア (次のカードのためにリセット)
                        $('#modal-image-container').empty().hide();
                        $('#modal-footer-title').empty();
                        $('#modal-detail').empty();

                        // モーダルが閉じるときにスクロール位置をリセットする
                        $scrollContainer.scrollTop(0);
                    });
                }, 600);
            };

            // 閉じるボタンがクリックされたとき
            $('#close-modal-button').on('click', function (e) {
                e.preventDefault();
                closeModal();
            });

            // オーバーレイ（モーダル背景）がクリックされたとき
            $('#feature-detail-modal').on('click', function (e) {
                // クリックされた要素がモーダル自体（.modal-content-boxの外部）であるかを確認
                if (e.target.id === 'feature-detail-modal') {
                    closeModal();
                }
            });

            // モーダルコンテンツ内をクリックしても閉じないようにイベント伝播を停止
            $('.modal-content-box').on('click', function (e) {
                e.stopPropagation();
            });
        });
    </script>
</body>
</html>